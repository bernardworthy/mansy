{"version":3,"sources":["app.js","etsy-api.js","initial-page.js","init.js"],"names":["app","EtsyApi","spec","apiKey","Error","baseUrl","apiVersion","self","listings","url","promise","$","Deferred","req","getJSON","done","data","ok","resolve","reject","userDetail","userId","api","showInitialPage","listingTemplate","_","template","html","variable","items","results","click","link","this","item","parent","console","log","first_name","insertBefore","fail","status","err"],"mappings":"AACA,GAAAA,OCDAA,KAAAC,QAAA,SAAAC,GACA,IAAAA,EAAAC,OACA,KAAA,IAAAC,OAAA,0BAGA,IAAAC,GAAA,6BAAAH,EAAAI,YAAA,MAEAC,GACAC,SAAA,WACA,GAAAC,GAAAJ,EAAA,kDAAAH,EAAAC,OAAA,cACAO,EAAAC,EAAAC,WAEAC,EAAAF,EAAAG,QAAAL,GAAAM,KAAA,SAAAC,GACAA,EAAAC,GAMAP,EAAAQ,QAAAF,GAFAN,EAAAS,OAAAN,EAAA,gBAAAG,IAMA,OAAAN,IAGAU,WAAA,SAAAC,GAGA,GAAAZ,GAAAJ,EAAA,UAAAgB,EAAA,uBAAAnB,EAAAC,OAAA,cACAO,EAAAC,EAAAC,WAEAC,EAAAF,EAAAG,QAAAL,GAAAM,KAAA,SAAAC,GACAA,EAAAC,GAIAP,EAAAQ,QAAAF,GAFAN,EAAAS,OAAAN,EAAA,gBAAAG,IAMA,OAAAN,IAIA,OAAAH,IC7CAP,IAAAsB,IAAAtB,IAAAC,SAAAE,OAAA,6BAEAH,IAAAuB,gBAAA,WAEAvB,IAAAsB,IAAAd,WACAO,KAAA,SAAAC,GAEA,GAAAQ,GAAAC,EAAAC,SAAAf,EAAA,aAAAgB,QAAAC,SAAA,KAEAjB,GAAA,QAAAgB,KAAAH,GAAAK,MAAAb,EAAAc,WAEAnB,EAAA,iBAAAoB,MAAA,WACA,GAAAC,GAAArB,EAAAsB,MACAC,EAAAF,EAAAG,SAAAA,SAAA,GACAd,EAAAV,EAAAuB,GAAAlB,KAAA,KAEAhB,KAAAsB,IAAAF,WAAAC,GACAN,KAAA,SAAAC,GAEAS,EAAAC,SAAAf,EAAA,YAAAgB,QAAAC,SAAA,KAEAQ,SAAAC,IAAArB,GACAoB,QAAAC,IAAAhB,GACAV,EAAA,MAAAK,EAAAc,QAAA,GAAAQ,WAAA,QAAAC,aAAA5B,EAAA,gBAAAuB,MAYAM,KAAA,SAAA3B,EAAA4B,EAAAC,GACAN,QAAAC,IAAAK,SAuBAF,KAAA,SAAA3B,EAAA4B,EAAAC,GACAN,QAAAC,IAAAK,MC5DA1C,IAAAuB","file":"app.js","sourcesContent":["// The namespace for this application\nvar app = {};\n","app.EtsyApi = function (spec) {\n  if (!spec.apiKey) {\n    throw new Error('An API key is required!');\n  }\n\n  var baseUrl = 'https://openapi.etsy.com/' + (spec.apiVersion || 'v2');\n\n  var self = {\n    listings: function () {\n      var url = baseUrl + '/listings/active.js?includes=MainImage&api_key=' + spec.apiKey + '&callback=?';\n      var promise = $.Deferred();\n\n      var req = $.getJSON(url).done(function (data) {\n        if (!data.ok) {\n          // Keep our rejection in line with the standard jQuery\n          // rejection, passing req as first argument, status as second\n          // and error object as the third\n          promise.reject(req, 'Unknown error', data);\n        } else {\n          promise.resolve(data);\n        }\n      });\n\n      return promise;\n    },\n\n    userDetail: function (userId) {\n      /* TODO: Call the Etsy profile API */\n      //users/19181170/profile.js?api_key=pq046kugg8nrx8f2mu71awb7&callback=\n      var url = baseUrl + '/users/' + userId + '/profile.js?api_key=' + spec.apiKey + '&callback=?';\n      var promise = $.Deferred();\n\n      var req = $.getJSON(url).done(function(data) {\n        if (!data.ok) {\n\n          promise.reject(req, 'Unknown error', data);\n        } else {\n          promise.resolve(data);\n        }\n      });\n\n      return promise;\n    }\n  };\n\n  return self;\n};\n","app.api = app.EtsyApi({apiKey: 'pq046kugg8nrx8f2mu71awb7'});\n\napp.showInitialPage = function () {\n\n  app.api.listings()\n    .done(function(data) {\n      // console.log(data);\n      var listingTemplate = _.template($('#listings').html(), {variable: 'm'});\n\n      $('body').html(listingTemplate({items: data.results}));\n\n      $('.profile-link').click(function(e) {\n        var link = $(this);\n        var item = link.parent().parent()[0];\n        var userId = $(item).data('id');\n\n        app.api.userDetail(userId)\n        .done(function(data) {\n          // console.log(data);\n          var profileTemplate = _.template($('#profile').html(), {variable: 'm'});\n\n          console.log(data);\n          console.log(userId);\n          $('<p>' + data.results[0].first_name + '</p>').insertBefore($('.text-content', item));\n          // var firstName = data.results[0].first_name;\n          // var loginName = data.results[0].login_name;\n          // var bio = data.results[0].bio;\n          // var city = data.results[0].city;\n          // var avatar = data.results[0].image_url_75x75;\n\n\n\n          // $('<img src=\"' + data.results[0].image_url_75x75 + '\"/>').insertBefore($('.text-content'));\n\n        })\n        .fail(function(req, status, err) {\n          console.log(err);\n        });\n      });\n\n      // var image = data.results[0].MainImage.url_570xN;\n      // var title = data.results[0].title;\n      // var link = data.results[0].url;\n      // var desc = data.results[0].description;\n      // var price = data.results[0].price;\n      // var currency = data.results[0].currency_code;\n      // for (i = 0; i < data.results.length; i++) {\n      //   var userId = data.results[i].user_id;\n      //   app.test(userId);\n      // }\n      //\n      // $('body').append('<img src=\"' + image + '\">');\n      // $('body').append('<h1>' + title + '</h1>');\n      // $('body').append('<h3>' + price + ' ' + currency + '</h3>');\n      // $('body').append('<a href=\"' + link + '\">Check out the Posting Here!</a>');\n      // $('body').append('<p>' + desc + '</p>');\n      //\n\n    })\n    .fail(function(req, status, err) {\n      console.log(err);\n    });\n\n};\n","app.showInitialPage();\n"],"sourceRoot":"/source/"}